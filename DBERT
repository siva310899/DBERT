{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"https://github.com/jalammar/jalammar.github.io/blob/master/notebooks/bert/A_Visual_Notebook_to_Using_BERT_for_the_First_Time.ipynb","timestamp":1677900008417}],"machine_shape":"hm"},"kernelspec":{"name":"python3","display_name":"Python 3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"b0925031cec5440c81f49c5530e60249":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b1a596dd0cc04961bb8f39e98e723578","IPY_MODEL_d7084c727fc740c099243f60e9b45e48","IPY_MODEL_3eaf456004af4124b3ec6512979209ed"],"layout":"IPY_MODEL_1b9cd050ccac4be4840ea58113840d8f"}},"b1a596dd0cc04961bb8f39e98e723578":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_66a1a70776cc495ca21b36e02fe13b76","placeholder":"​","style":"IPY_MODEL_3e5632745b354ed08ed2a7f3ae3ea7b5","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"d7084c727fc740c099243f60e9b45e48":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6fa81316048a4cba84ba8cb27b66b189","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bd3bd0e303e14620996f600fbb769f02","value":231508}},"3eaf456004af4124b3ec6512979209ed":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4fdc35733db34fa49f0a1ecc375bc3e9","placeholder":"​","style":"IPY_MODEL_20cc5354229d47d69b45e9edb4c72872","value":" 232k/232k [00:00&lt;00:00, 893kB/s]"}},"1b9cd050ccac4be4840ea58113840d8f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"66a1a70776cc495ca21b36e02fe13b76":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e5632745b354ed08ed2a7f3ae3ea7b5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6fa81316048a4cba84ba8cb27b66b189":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bd3bd0e303e14620996f600fbb769f02":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4fdc35733db34fa49f0a1ecc375bc3e9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"20cc5354229d47d69b45e9edb4c72872":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"011879035b1f4c6bb69df272c705476f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9603553d5e3e445e8e2a3ff692bec1ea","IPY_MODEL_a514ca29f0f94327bb7e01235b9592de","IPY_MODEL_eb1e093cfbfe4718be4bf48aa819888e"],"layout":"IPY_MODEL_57821bb892f64bccb8480862a5d8ba59"}},"9603553d5e3e445e8e2a3ff692bec1ea":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3340f7b615034e1fa6b968afef8b97aa","placeholder":"​","style":"IPY_MODEL_a1e2e307182545c296150a8110827a97","value":"Downloading (…)okenizer_config.json: 100%"}},"a514ca29f0f94327bb7e01235b9592de":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_34d952c5c5914a26bde39eb87300f82b","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d2a98ec224934246a21b12495227284c","value":28}},"eb1e093cfbfe4718be4bf48aa819888e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fcfb6c8bd4474966a867676f7485e7a6","placeholder":"​","style":"IPY_MODEL_c2b2c630539b4f5ca41bc768098872b2","value":" 28.0/28.0 [00:00&lt;00:00, 1.45kB/s]"}},"57821bb892f64bccb8480862a5d8ba59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3340f7b615034e1fa6b968afef8b97aa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a1e2e307182545c296150a8110827a97":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"34d952c5c5914a26bde39eb87300f82b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2a98ec224934246a21b12495227284c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"fcfb6c8bd4474966a867676f7485e7a6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c2b2c630539b4f5ca41bc768098872b2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d993e6b5e8d64435ad55e98f115d456e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1ddb97f47e954b99bc45a7777b3d7585","IPY_MODEL_e58ae221022e4d66be3e8b602d627462","IPY_MODEL_a6ef0b09c22f4037be1f0fe888fc5754"],"layout":"IPY_MODEL_fd6a3f0d10c14faaa1185ff035ef610f"}},"1ddb97f47e954b99bc45a7777b3d7585":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_10dbf7106be9444491bca435c7e68ef2","placeholder":"​","style":"IPY_MODEL_394f9dff39544a3ea674128b7e041d35","value":"Downloading (…)lve/main/config.json: 100%"}},"e58ae221022e4d66be3e8b602d627462":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2392dfe4e68b4020bf282a09675aad5e","max":483,"min":0,"orientation":"horizontal","style":"IPY_MODEL_350f5ac7b3b34a6c9357f7b744c6e3e6","value":483}},"a6ef0b09c22f4037be1f0fe888fc5754":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b0c4330eacdb445f90f26ecb03d5cad4","placeholder":"​","style":"IPY_MODEL_44cb7eebbf9c4a29bd805637747e0765","value":" 483/483 [00:00&lt;00:00, 26.8kB/s]"}},"fd6a3f0d10c14faaa1185ff035ef610f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10dbf7106be9444491bca435c7e68ef2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"394f9dff39544a3ea674128b7e041d35":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2392dfe4e68b4020bf282a09675aad5e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"350f5ac7b3b34a6c9357f7b744c6e3e6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b0c4330eacdb445f90f26ecb03d5cad4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"44cb7eebbf9c4a29bd805637747e0765":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"81bf5888d27446a088989bd836951178":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a29252c78d2f4f2c95a8a42ea3b72464","IPY_MODEL_4a44f37e6e474a8e95a863c9710305ff","IPY_MODEL_0e99b6a057be4f58ac7039e649a1fa96"],"layout":"IPY_MODEL_145fe3352e4a41b9b99c95877ed2ea72"}},"a29252c78d2f4f2c95a8a42ea3b72464":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_41389923385c4440bceb62cf58ca6325","placeholder":"​","style":"IPY_MODEL_a2f9d53745ac42f39a587e19fa950b99","value":"Downloading (…)&quot;pytorch_model.bin&quot;;: 100%"}},"4a44f37e6e474a8e95a863c9710305ff":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5a67447e666a4dfe8041be364c6be349","max":267967963,"min":0,"orientation":"horizontal","style":"IPY_MODEL_06b3fbb0982d4c809fe1f0204aac7a18","value":267967963}},"0e99b6a057be4f58ac7039e649a1fa96":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_108673e2672f4ba295808e4022b87bda","placeholder":"​","style":"IPY_MODEL_fbaa573aefcd4ef9b57c2e72c575d1d8","value":" 268M/268M [00:00&lt;00:00, 347MB/s]"}},"145fe3352e4a41b9b99c95877ed2ea72":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"41389923385c4440bceb62cf58ca6325":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a2f9d53745ac42f39a587e19fa950b99":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5a67447e666a4dfe8041be364c6be349":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"06b3fbb0982d4c809fe1f0204aac7a18":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"108673e2672f4ba295808e4022b87bda":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fbaa573aefcd4ef9b57c2e72c575d1d8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","metadata":{"id":"To9ENLU90WGl","outputId":"73620d23-0d11-4660-9986-d783520a6208","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1688484338231,"user_tz":-330,"elapsed":12983,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["!pip install transformers"],"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers\n","  Downloading transformers-4.30.2-py3-none-any.whl (7.2 MB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/7.2 MB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[91m━\u001b[0m\u001b[91m╸\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.3/7.2 MB\u001b[0m \u001b[31m9.6 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━\u001b[0m\u001b[90m╺\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.1/7.2 MB\u001b[0m \u001b[31m44.5 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m78.2 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m55.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.2)\n","Collecting huggingface-hub<1.0,>=0.14.1 (from transformers)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m27.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m101.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers)\n","  Downloading safetensors-0.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m67.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.6.3)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.16)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2023.5.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Installing collected packages: tokenizers, safetensors, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.15.1 safetensors-0.3.1 tokenizers-0.13.3 transformers-4.30.2\n"]}]},{"cell_type":"code","metadata":{"id":"fvFvBLJV0Dkv","executionInfo":{"status":"ok","timestamp":1688484369109,"user_tz":-330,"elapsed":7320,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["import numpy as np\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.model_selection import cross_val_score\n","import torch\n","import transformers as ppb\n","import warnings\n","warnings.filterwarnings('ignore')"],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"zQ-42fh0hjsF"},"source":["## Importing the dataset\n","We'll use pandas to read the dataset and load it into a dataframe."]},{"cell_type":"code","source":["#glue"],"metadata":{"id":"B0q0zxfChQ4y"},"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"cyoj29J24hPX","executionInfo":{"status":"ok","timestamp":1688484500360,"user_tz":-330,"elapsed":629,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["df = pd.read_csv('https://github.com/clairett/pytorch-sentiment-classification/raw/master/data/SST2/train.tsv', delimiter='\\t', header=None)"],"execution_count":3,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"dMVE3waNhuNj"},"source":["For performance reasons, we'll only use 2,000 sentences from the dataset"]},{"cell_type":"code","metadata":{"id":"gTM3hOHW4hUY"},"source":["batch_1 = df[:2000]"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["batch_1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"dsSbA4tk4gIf","executionInfo":{"status":"ok","timestamp":1677906915413,"user_tz":-330,"elapsed":5,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"42c21f90-e72d-4d7d-9902-cfc8091ba3d0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                      0  1\n","0     a stirring , funny and finally transporting re...  1\n","1     apparently reassembled from the cutting room f...  0\n","2     they presume their audience wo n't sit still f...  0\n","3     this is a visually stunning rumination on love...  1\n","4     jonathan parker 's bartleby should have been t...  1\n","...                                                 ... ..\n","1995  too bland and fustily tasteful to be truly pru...  0\n","1996                         it does n't work as either  0\n","1997  this one aims for the toilet and scores a dire...  0\n","1998  in the name of an allegedly inspiring and easi...  0\n","1999  the movie is undone by a filmmaking methodolog...  0\n","\n","[2000 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-1c348c12-36d9-401c-8680-519ca10ef7d4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","      <th>1</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>a stirring , funny and finally transporting re...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>apparently reassembled from the cutting room f...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>they presume their audience wo n't sit still f...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>this is a visually stunning rumination on love...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>jonathan parker 's bartleby should have been t...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1995</th>\n","      <td>too bland and fustily tasteful to be truly pru...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1996</th>\n","      <td>it does n't work as either</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1997</th>\n","      <td>this one aims for the toilet and scores a dire...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1998</th>\n","      <td>in the name of an allegedly inspiring and easi...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1999</th>\n","      <td>the movie is undone by a filmmaking methodolog...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2000 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1c348c12-36d9-401c-8680-519ca10ef7d4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1c348c12-36d9-401c-8680-519ca10ef7d4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1c348c12-36d9-401c-8680-519ca10ef7d4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}]},{"cell_type":"markdown","metadata":{"id":"PRc2L89hh1Tf"},"source":["We can ask pandas how many sentences are labeled as \"positive\" (value 1) and how many are labeled \"negative\" (having the value 0)"]},{"cell_type":"code","metadata":{"id":"jGvcfcCP5xpZ","outputId":"2c3f1b0a-1077-42ab-d62e-645c204509bc","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1677906943824,"user_tz":-330,"elapsed":423,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["batch_1[1].value_counts()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1    1041\n","0     959\n","Name: 1, dtype: int64"]},"metadata":{},"execution_count":7}]},{"cell_type":"markdown","metadata":{"id":"7_MO08_KiAOb"},"source":["## Loading the Pre-trained BERT model\n","Let's now load a pre-trained BERT model."]},{"cell_type":"code","metadata":{"id":"q1InADgf5xm2","outputId":"f02ecc36-f1db-4470-fbbf-40f0b8aff71c","colab":{"base_uri":"https://localhost:8080/","height":219,"referenced_widgets":["b0925031cec5440c81f49c5530e60249","b1a596dd0cc04961bb8f39e98e723578","d7084c727fc740c099243f60e9b45e48","3eaf456004af4124b3ec6512979209ed","1b9cd050ccac4be4840ea58113840d8f","66a1a70776cc495ca21b36e02fe13b76","3e5632745b354ed08ed2a7f3ae3ea7b5","6fa81316048a4cba84ba8cb27b66b189","bd3bd0e303e14620996f600fbb769f02","4fdc35733db34fa49f0a1ecc375bc3e9","20cc5354229d47d69b45e9edb4c72872","011879035b1f4c6bb69df272c705476f","9603553d5e3e445e8e2a3ff692bec1ea","a514ca29f0f94327bb7e01235b9592de","eb1e093cfbfe4718be4bf48aa819888e","57821bb892f64bccb8480862a5d8ba59","3340f7b615034e1fa6b968afef8b97aa","a1e2e307182545c296150a8110827a97","34d952c5c5914a26bde39eb87300f82b","d2a98ec224934246a21b12495227284c","fcfb6c8bd4474966a867676f7485e7a6","c2b2c630539b4f5ca41bc768098872b2","d993e6b5e8d64435ad55e98f115d456e","1ddb97f47e954b99bc45a7777b3d7585","e58ae221022e4d66be3e8b602d627462","a6ef0b09c22f4037be1f0fe888fc5754","fd6a3f0d10c14faaa1185ff035ef610f","10dbf7106be9444491bca435c7e68ef2","394f9dff39544a3ea674128b7e041d35","2392dfe4e68b4020bf282a09675aad5e","350f5ac7b3b34a6c9357f7b744c6e3e6","b0c4330eacdb445f90f26ecb03d5cad4","44cb7eebbf9c4a29bd805637747e0765","81bf5888d27446a088989bd836951178","a29252c78d2f4f2c95a8a42ea3b72464","4a44f37e6e474a8e95a863c9710305ff","0e99b6a057be4f58ac7039e649a1fa96","145fe3352e4a41b9b99c95877ed2ea72","41389923385c4440bceb62cf58ca6325","a2f9d53745ac42f39a587e19fa950b99","5a67447e666a4dfe8041be364c6be349","06b3fbb0982d4c809fe1f0204aac7a18","108673e2672f4ba295808e4022b87bda","fbaa573aefcd4ef9b57c2e72c575d1d8"]},"executionInfo":{"status":"ok","timestamp":1677906951532,"user_tz":-330,"elapsed":5974,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["# For DistilBERT:\n","model_class, tokenizer_class, pretrained_weights = (ppb.DistilBertModel, ppb.DistilBertTokenizer, 'distilbert-base-uncased')\n","\n","## Want BERT instead of distilBERT? Uncomment the following line:\n","#model_class, tokenizer_class, pretrained_weights = (ppb.BertModel, ppb.BertTokenizer, 'bert-base-uncased')\n","\n","# Load pretrained model/tokenizer\n","tokenizer = tokenizer_class.from_pretrained(pretrained_weights)\n","model = model_class.from_pretrained(pretrained_weights)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b0925031cec5440c81f49c5530e60249"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"011879035b1f4c6bb69df272c705476f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/483 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d993e6b5e8d64435ad55e98f115d456e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)\"pytorch_model.bin\";:   0%|          | 0.00/268M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"81bf5888d27446a088989bd836951178"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilbert-base-uncased were not used when initializing DistilBertModel: ['vocab_transform.bias', 'vocab_projector.weight', 'vocab_projector.bias', 'vocab_layer_norm.weight', 'vocab_layer_norm.bias', 'vocab_transform.weight']\n","- This IS expected if you are initializing DistilBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DistilBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]}]},{"cell_type":"markdown","metadata":{"id":"lZDBMn3wiSX6"},"source":["Right now, the variable `model` holds a pretrained distilBERT model -- a version of BERT that is smaller, but much faster and requiring a lot less memory.\n","\n","## Model #1: Preparing the Dataset\n","Before we can hand our sentences to BERT, we need to do some minimal processing to put them in the format it requires.\n","\n","### Tokenization\n","Our first step is to tokenize the sentences -- break them up into word and subwords in the format BERT is comfortable with."]},{"cell_type":"code","metadata":{"id":"Dg82ndBA5xlN"},"source":["tokenized = batch_1[0].apply((lambda x: tokenizer.encode(x, add_special_tokens=True)))"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"mHwjUwYgi-uL"},"source":["<img src=\"https://jalammar.github.io/images/distilBERT/bert-distilbert-tokenization-2-token-ids.png\" />\n","\n","### Padding\n","After tokenization, `tokenized` is a list of sentences -- each sentences is represented as a list of tokens. We want BERT to process our examples all at once (as one batch). It's just faster that way. For that reason, we need to pad all lists to the same size, so we can represent the input as one 2-d array, rather than a list of lists (of different lengths)."]},{"cell_type":"code","source":["tokenized"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DH7i03Cq7Llv","executionInfo":{"status":"ok","timestamp":1677906957148,"user_tz":-330,"elapsed":426,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"b152f9e2-f80e-40eb-cb3d-38abbd883d82"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0       [101, 1037, 18385, 1010, 6057, 1998, 2633, 182...\n","1       [101, 4593, 2128, 27241, 23931, 2013, 1996, 62...\n","2       [101, 2027, 3653, 23545, 2037, 4378, 24185, 10...\n","3       [101, 2023, 2003, 1037, 17453, 14726, 19379, 1...\n","4       [101, 5655, 6262, 1005, 1055, 12075, 2571, 376...\n","                              ...                        \n","1995    [101, 2205, 20857, 1998, 11865, 16643, 2135, 5...\n","1996    [101, 2009, 2515, 1050, 1005, 1056, 2147, 2004...\n","1997    [101, 2023, 2028, 8704, 2005, 1996, 11848, 199...\n","1998    [101, 1999, 1996, 2171, 1997, 2019, 9382, 1898...\n","1999    [101, 1996, 3185, 2003, 25757, 2011, 1037, 244...\n","Name: 0, Length: 2000, dtype: object"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","metadata":{"id":"URn-DWJt5xhP"},"source":["max_len = 0\n","for i in tokenized.values:\n","    if len(i) > max_len:\n","        max_len = len(i)\n","\n","\n","\n","padded = np.array([i + [0]*(max_len-len(i)) for i in tokenized.values])"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["padded"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qnZ_D6KD9FtI","executionInfo":{"status":"ok","timestamp":1677906961140,"user_tz":-330,"elapsed":2,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"ef689eee-2fa0-4b6b-937a-a9055a2dd83a"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[  101,  1037, 18385, ...,     0,     0,     0],\n","       [  101,  4593,  2128, ...,     0,     0,     0],\n","       [  101,  2027,  3653, ...,     0,     0,     0],\n","       ...,\n","       [  101,  2023,  2028, ...,     0,     0,     0],\n","       [  101,  1999,  1996, ...,     0,     0,     0],\n","       [  101,  1996,  3185, ...,     0,     0,     0]])"]},"metadata":{},"execution_count":12}]},{"cell_type":"markdown","metadata":{"id":"Mdjg306wjjmL"},"source":["Our dataset is now in the `padded` variable, we can view its dimensions below:"]},{"cell_type":"code","metadata":{"id":"jdi7uXo95xeq","outputId":"a7e5cfe6-fc4d-422d-ef91-3661d793297e","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1677906964219,"user_tz":-330,"elapsed":660,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["np.array(padded).shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(2000, 59)"]},"metadata":{},"execution_count":13}]},{"cell_type":"markdown","metadata":{"id":"sDZBsYSDjzDV"},"source":["### Masking\n","If we directly send `padded` to BERT, that would slightly confuse it. We need to create another variable to tell it to ignore (mask) the padding we've added when it's processing its input. That's what attention_mask is:"]},{"cell_type":"code","metadata":{"id":"4K_iGRNa_Ozc","outputId":"250349dc-6f6a-448d-a668-6c62f5e9ff74","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1677906965433,"user_tz":-330,"elapsed":2,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["attention_mask = np.where(padded != 0, 1, 0)\n","attention_mask.shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(2000, 59)"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["attention_mask"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WHn_AvST9NQb","executionInfo":{"status":"ok","timestamp":1677906968963,"user_tz":-330,"elapsed":565,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"ed25f689-496d-46a0-ec46-6962c1bbfa04"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 1, 1, ..., 0, 0, 0],\n","       [1, 1, 1, ..., 0, 0, 0],\n","       [1, 1, 1, ..., 0, 0, 0],\n","       ...,\n","       [1, 1, 1, ..., 0, 0, 0],\n","       [1, 1, 1, ..., 0, 0, 0],\n","       [1, 1, 1, ..., 0, 0, 0]])"]},"metadata":{},"execution_count":15}]},{"cell_type":"markdown","metadata":{"id":"jK-CQB9-kN99"},"source":["## Model #1: And Now, Deep Learning!\n","Now that we have our model and inputs ready, let's run our model!\n","\n","<img src=\"https://jalammar.github.io/images/distilBERT/bert-distilbert-tutorial-sentence-embedding.png\" />\n","\n","The `model()` function runs our sentences through BERT. The results of the processing will be returned into `last_hidden_states`."]},{"cell_type":"code","metadata":{"id":"39UVjAV56PJz"},"source":["input_ids = torch.tensor(padded)\n","attention_mask = torch.tensor(attention_mask)\n","\n","with torch.no_grad():\n","    last_hidden_states = model(input_ids, attention_mask=attention_mask)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"FoCep_WVuB3v"},"source":["Let's slice only the part of the output that we need. That is the output corresponding the first token of each sentence. The way BERT does sentence classification, is that it adds a token called `[CLS]` (for classification) at the beginning of every sentence. The output corresponding to that token can be thought of as an embedding for the entire sentence.\n","\n","<img src=\"https://jalammar.github.io/images/distilBERT/bert-output-tensor-selection.png\" />\n","\n","We'll save those in the `features` variable, as they'll serve as the features to our logitics regression model."]},{"cell_type":"code","source":["max_len"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BqMkl8fW-lS_","executionInfo":{"status":"ok","timestamp":1677907230144,"user_tz":-330,"elapsed":9,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"daff2338-a94d-4390-b6ea-b3d979ec02a2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["59"]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["last_hidden_states[0][0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UJpqRwHA-OzT","executionInfo":{"status":"ok","timestamp":1677907230144,"user_tz":-330,"elapsed":7,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"b0363cc6-88b6-4ba3-bea1-7b99d74d8304"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[-0.2159, -0.1403,  0.0083,  ..., -0.1369,  0.5867,  0.2011],\n","        [-0.2471,  0.2468,  0.1008,  ..., -0.1631,  0.9349, -0.0715],\n","        [ 0.0558,  0.3573,  0.4140,  ..., -0.2430,  0.1770, -0.5080],\n","        ...,\n","        [-0.0165,  0.1179,  0.3512,  ..., -0.2401,  0.2722, -0.1750],\n","        [ 0.0961,  0.0667,  0.3147,  ..., -0.3277,  0.3556, -0.2135],\n","        [ 0.0454,  0.0519,  0.3168,  ..., -0.2880,  0.1844, -0.1042]])"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","metadata":{"id":"C9t60At16PVs"},"source":["features = np.quantile(last_hidden_states[0][:,:,:].numpy(),0.5,axis=1)"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["np.quantile"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"q7hjL7xtEZFI","executionInfo":{"status":"ok","timestamp":1677907309812,"user_tz":-330,"elapsed":452,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"0ef16999-ff54-45a2-a969-77912f151189"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<function numpy.quantile(a, q, axis=None, out=None, overwrite_input=False, method='linear', keepdims=False, *, interpolation=None)>"]},"metadata":{},"execution_count":30}]},{"cell_type":"code","source":["features.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Wzzw59eS_TWD","executionInfo":{"status":"ok","timestamp":1677907347725,"user_tz":-330,"elapsed":5,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}},"outputId":"626172c0-10a0-4ab9-fa05-b8d453761ca4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(2000, 768)"]},"metadata":{},"execution_count":32}]},{"cell_type":"markdown","metadata":{"id":"_VZVU66Gurr-"},"source":["The labels indicating which sentence is positive and negative now go into the `labels` variable"]},{"cell_type":"code","metadata":{"id":"JD3fX2yh6PTx"},"source":["labels = batch_1[1]"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"iaoEvM2evRx1"},"source":["## Model #2: Train/Test Split\n","Let's now split our datset into a training set and testing set (even though we're using 2,000 sentences from the SST2 training set)."]},{"cell_type":"code","metadata":{"id":"ddAqbkoU6PP9"},"source":["train_features, test_features, train_labels, test_labels = train_test_split(features, labels)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"B9bhSJpcv1Bl"},"source":["<img src=\"https://jalammar.github.io/images/distilBERT/bert-distilbert-train-test-split-sentence-embedding.png\" />\n","\n","### [Bonus] Grid Search for Parameters\n","We can dive into Logistic regression directly with the Scikit Learn default parameters, but sometimes it's worth searching for the best value of the C parameter, which determines regularization strength."]},{"cell_type":"code","metadata":{"id":"cyEwr7yYD3Ci"},"source":["# parameters = {'C': np.linspace(0.0001, 100, 20)}\n","# grid_search = GridSearchCV(LogisticRegression(), parameters)\n","# grid_search.fit(train_features, train_labels)\n","\n","# print('best parameters: ', grid_search.best_params_)\n","# print('best scrores: ', grid_search.best_score_)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"KCT9u8vAwnID"},"source":["We now train the LogisticRegression model. If you've chosen to do the gridsearch, you can plug the value of C into the model declaration (e.g. `LogisticRegression(C=5.2)`)."]},{"cell_type":"code","metadata":{"id":"gG-EVWx4CzBc","outputId":"e2135496-c69f-4ccc-d4d8-22db1c222898","colab":{"base_uri":"https://localhost:8080/","height":75},"executionInfo":{"status":"ok","timestamp":1677907358182,"user_tz":-330,"elapsed":456,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["lr_clf = LogisticRegression()\n","lr_clf.fit(train_features, train_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["LogisticRegression()"],"text/html":["<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-3\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LogisticRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" checked><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div></div></div>"]},"metadata":{},"execution_count":35}]},{"cell_type":"markdown","metadata":{"id":"3rUMKuVgwzkY"},"source":["<img src=\"https://jalammar.github.io/images/distilBERT/bert-training-logistic-regression.png\" />\n","\n","## Evaluating Model #2\n","So how well does our model do in classifying sentences? One way is to check the accuracy against the testing dataset:"]},{"cell_type":"code","metadata":{"id":"iCoyxRJ7ECTA","outputId":"c567eb77-9fd2-45e9-8f77-0cdc202f733f","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1677907361975,"user_tz":-330,"elapsed":4,"user":{"displayName":"sam statistics","userId":"15787176024529158926"}}},"source":["lr_clf.score(test_features, test_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.824"]},"metadata":{},"execution_count":36}]},{"cell_type":"markdown","metadata":{"id":"75oyhr3VxHoE"},"source":["How good is this score? What can we compare it against? Let's first look at a dummy classifier:"]},{"cell_type":"code","metadata":{"id":"lnwgmqNG7i5l","outputId":"0042aed2-4fa8-4fa0-bf25-fdef70a10aac","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["from sklearn.dummy import DummyClassifier\n","clf = DummyClassifier()\n","\n","scores = cross_val_score(clf, train_features, train_labels)\n","print(\"Dummy classifier score: %0.3f (+/- %0.2f)\" % (scores.mean(), scores.std() * 2))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Dummy classifier score: 0.527 (+/- 0.05)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7Lg4LOpoxSOR"},"source":["So our model clearly does better than a dummy classifier. But how does it compare against the best models?\n","\n","## Proper SST2 scores\n","For reference, the [highest accuracy score](http://nlpprogress.com/english/sentiment_analysis.html) for this dataset is currently **96.8**. DistilBERT can be trained to improve its score on this task – a process called **fine-tuning** which updates BERT’s weights to make it achieve a better performance in this sentence classification task (which we can call the downstream task). The fine-tuned DistilBERT turns out to achieve an accuracy score of **90.7**. The full size BERT model achieves **94.9**.\n","\n","\n","\n","And that’s it! That’s a good first contact with BERT. The next step would be to head over to the documentation and try your hand at [fine-tuning](https://huggingface.co/transformers/examples.html#glue). You can also go back and switch from distilBERT to BERT and see how that works."]},{"cell_type":"code","metadata":{"id":"EJQuqV6cnWQu"},"source":[],"execution_count":null,"outputs":[]}]}